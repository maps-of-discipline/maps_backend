# Задачи по Разработке Веб-приложения "Матрицы Компетенций"

**Проект:** Академический Прогресс / Карты Дисциплин (Бэкенд + Фронтенд)
**Компонент:** `competencies_matrix`
**Версия Документа:** 3.0 *(Новый фокус: UI/UX + Интеграция КД)*
**Дата:** 2025-05-07

---

## 0. Приоритет и Цель MVP (Minimum Viable Product) - До Защиты

**Приоритет:** Создать **функциональный и понятный Frontend**, демонстрирующий основной **workflow просмотра и ручного редактирования** матрицы компетенций ("Дисциплина ↔ ИДК").
**Источник данных:**
*   **Дисциплины АУП:** Получать из **БД "Карт Дисциплин" (КД)** через API бэкенда.
*   **УК/ОПК/ИУК/ИОПК:** Из **локальной БД**, наполненной через `seed_db`.
*   **ПК/ИПК:** Из **локальной БД**, наполненной через `seed_db` + **ручной ввод через UI/API**.
*   **Связи Матрицы:** Из **локальной БД**, управляемой через UI/API.
**DoD для MVP:** Работающий UI для выбора ОП/АУП, отображения матрицы, редактирования связей, просмотра/добавления ПК/ИПК. Рабочие API для поддержки этого UI (включая прокси-запросы к КД).

---

## 1. Ближайшие Задачи (MVP - Frontend и поддерживающий Backend)

**История 1: Отображение и Ручное Редактирование Матрицы (Высокий Приоритет)**

*   **Цель:** Пользователь (методист) может выбрать АУП, увидеть соответствующую матрицу (Дисциплины из КД x ИДК из локальной БД) и вручную изменить связи.
*   **Статус:** [ ] **К выполнению**.
*   **Задачи:**
    *   [ ] **Задача 1.1 (Backend): Реализовать API для получения списка ОП и связанных АУП.**
        *   **Описание:** Создать эндпоинт `GET /api/competencies/programs-with-aups`, который вернет список ОП (из локальной `competencies_educational_program`) и для каждой ОП - список связанных АУП (запросом к БД КД по `num_aup` или другим ключам). Потребуется настройка подключения ко второй БД (`SQLALCHEMY_BINDS` в Flask).
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`, `config.py`.
    *   [ ] **Задача 1.2 (Backend): Реализовать API для получения дисциплин АУП.**
        *   **Описание:** Создать эндпоинт `GET /api/competencies/aups/<aup_id>/disciplines`, который по `aup_id` (из `tbl_aup` БД КД) вернет список дисциплин (из `aup_data` БД КД).
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`, `config.py`.
    *   [ ] **Задача 1.3 (Frontend): UI для выбора ОП и АУП.**
        *   **Описание:** Доработать `ProgramsView.vue` или создать новый компонент/выпадающий список, использующий API из Задачи 1.1 для выбора ОП, и затем API из Задачи 1.2 (или данные из 1.1) для выбора конкретного АУП. Выбранный `aup_id` должен передаваться в `MatrixView`.
        *   **Компоненты:** `cabinet_frontend/src/views/competencies/ProgramsView.vue`, `MatrixView.vue`, `services/api/competenciesApi.ts`.
    *   [ ] **Задача 1.4 (Frontend): Отображение Матрицы (`MatrixTable.vue`).**
        *   **Описание:** Доработать `MatrixTable.vue`, чтобы он корректно принимал и отображал:
            *   Строки: Дисциплины, полученные из API Задачи 1.2.
            *   Столбцы: Компетенции и Индикаторы, полученные из API `GET /matrix/<aup_id>` (который теперь берет их из локальной БД).
            *   Чекбоксы: Состояние на основе `links` из API `GET /matrix/<aup_id>`.
        *   **Компоненты:** `cabinet_frontend/src/components/competencies/MatrixTable.vue`.
    *   [ ] **Задача 1.5 (Frontend): Реализовать Редактирование Связей.**
        *   **Описание:** Обеспечить, чтобы изменение состояния чекбокса в `MatrixTable.vue` вызывало соответствующие API `POST/DELETE /matrix/link` для сохранения/удаления связи в локальной БД. Обновлять состояние таблицы после успешного ответа API.
        *   **Компоненты:** `cabinet_frontend/src/components/competencies/MatrixTable.vue`, `stores/competenciesMatrix.ts`.
    *   [ ] **Задача 1.6 (Backend): Верифицировать API `GET /matrix/<aup_id>`.**
        *   **Описание:** Убедиться, что этот API корректно получает УК/ОПК/ПК/ИДК из *локальной* БД (фильтры, сортировка) и связи из `competencies_matrix`, и возвращает их в ожидаемом формате. Данные о дисциплинах он теперь *не* возвращает (их получает фронтенд отдельно).
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`.
    *   [ ] **Задача 1.7 (Backend): Верифицировать API `POST/DELETE /matrix/link`.**
        *   **Описание:** Убедиться, что эти API корректно работают с *локальной* таблицей `competencies_matrix`.
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`.

**История 2: Ручное Управление Профессиональными Компетенциями (ПК) и Индикаторами (ИПК) (Средний Приоритет)**

*   **Цель:** Дать методисту возможность добавлять и просматривать ПК/ИПК, необходимые для заполнения матрицы, если их нет в базовом наборе.
*   **Статус:** [ ] **К выполнению**.
*   **Задачи:**
    *   [ ] **Задача 2.1 (Backend): Реализовать API для CRUD ПК/ИПК.**
        *   **Описание:** Доработать API (`/competencies`, `/indicators`) для поддержки базовых операций GET (список, по ID) и POST (создание) для ПК и ИПК в локальной БД. PATCH/DELETE - опционально для MVP.
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`.
    *   [ ] **Задача 2.2 (Frontend): UI для Просмотра и Добавления ПК/ИПК.**
        *   **Описание:** Создать страницу/компонент (`CompetenciesAdminView.vue`?) для отображения списка всех компетенций/индикаторов (из локальной БД). Реализовать форму для добавления новых ПК и ИПК (вызов API POST).
        *   **Компоненты:** `cabinet_frontend/src/views/competencies/CompetenciesAdminView.vue` (новый), `services/api/competenciesApi.ts`.

**История 3: Базовая Работа с ФГОС и ПС (Низкий Приоритет для MVP)**

*   **Цель:** Обеспечить возможность просмотра загруженных ФГОС и ПС. Глубокий парсинг и формирование ПК/ИПК на их основе - **вне MVP**.
*   **Статус:** [ ] **К выполнению**.
*   **Задачи:**
    *   [ ] **Задача 3.1 (Backend): Верифицировать API для Просмотра ФГОС.**
        *   **Описание:** Убедиться, что API `GET /fgos` и `GET /fgos/<id>` корректно возвращают данные из локальной БД.
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`.
    *   [ ] **Задача 3.2 (Frontend): UI для Просмотра Списка ФГОС.**
        *   **Описание:** Доработать `FgosView.vue` для отображения списка ФГОС из API и открытия модального окна `FgosPreviewModal.vue` для просмотра деталей.
        *   **Компоненты:** `cabinet_frontend/src/views/competencies/FgosView.vue`, `components/competencies/FgosPreviewModal.vue`.
    *   [ ] **Задача 3.3 (Backend): Верифицировать API для Загрузки ПС.**
        *   **Описание:** Убедиться, что API `POST /profstandards/upload` корректно принимает файл и сохраняет его текст/Markdown в локальную БД (`competencies_prof_standard`).
        *   **Компоненты:** `competencies_matrix/logic.py`, `routes.py`, `parsers.py`.
    *   [ ] **Задача 3.4 (Frontend): UI для Загрузки и Просмотра Списка ПС.**
        *   **Описание:** Доработать `ProfStandardsView.vue` для отображения списка загруженных ПС (из локальной БД) и реализации формы для загрузки новых файлов ПС. Отображение Markdown - опционально.
        *   **Компоненты:** `cabinet_frontend/src/views/competencies/ProfStandardsView.vue`.

---

## 4. Задачи Backlog (После MVP / Для ВКР)

*   [ ] **Парсинг Структуры ПС:** Реализовать детальный парсинг ОТФ/ТФ/ТД/НУ/НЗ и сохранение в БД.
*   [ ] **UI Формирования ПК/ИПК:** Создать удобный интерфейс для выбора элементов ПС и формулирования на их основе ПК/ИПК.
*   [ ] **NLP Интеграция:** Подключить NLP для предложений связей и формулировок.
*   [ ] **Учет Успеваемости по ИДК:** Связать оценки с ИДК.
*   [ ] **Отчеты:** Генерация матрицы в DOCX и других отчетов.
*   [ ] **Локальное Кэширование/Синхронизация АУП:** Сохранять данные АУП из КД локально для снижения зависимости.
*   [ ] **Полный CRUD для ОП/ФГОС/ПС.**
*   [ ] **Тестирование (Unit/Integration).**
*   [ ] **Документация API.**
*   [ ] **Оптимизация производительности.**
*   [ ] **Улучшение UI/UX.**

---

Этот план ставит во главу угла **работу фронтенда и интеграцию с КД**, позволяя продемонстрировать основной сценарий работы с матрицей. Задачи по автоматизации и глубокой обработке данных перенесены на этап после MVP.